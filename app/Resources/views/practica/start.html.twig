{% extends 'base.html.twig' %}
{% block body %}
<div ng-controller="startPracticaController">
    <section class="content-header">
        <h1>Practica&nbsp;<small class="label bg-blue">{{practica.id}}</small>
            <span ng-if="finalizado" class="label label-warning pull-right">Finalizada</span>
            <span ng-if="!finalizado" class="label label-warning pull-right">Ejercicio [[ ejercicio.id + 1 ]] de {{practica.data|length }}</span>
        </h1>
    </section>
    <section class="content">
        <div class="box box-primary">
            <div class="box-body">
                <div class="form-group col-xs-12" ng-hide="finalizado">
                    <h4 class="col-md-4 col-sm-6"><i class="fa fa-check"></i> Aciertos <small class="label label-default">[[ aciertos ]]</small></h4>
                    <h4 class="col-md-4">Dificultad <small class="label label-default">{{ practica.data[0]['ejercicio'].dificultadString }}</small></h4>
                    <h4 class="col-md-4"><i class="fa fa-book"></i> Tema <a href="{{ path('tema_show', {'id': practica.data[0]['ejercicio'].tema.id }) }}">{{ practica.data[0]['ejercicio'].tema.nombre }}</a></h4>
                </div>
                <div class="form-group col-xs-12 check-element animate-hide" ng-hide="finalizado">
                    <div ng-bind-html="ejercicio.enunciado">
                    </div>
                    <ul class="list-group">
                        <li class="list-group-item col-md-6 col-xs-12" data-ng-repeat="respuesta in ejercicio.respuestas">
                            <div class="input-group">
                                <span class="input-group-addon">
                                    <input ng-disabled="evaluando" type="checkbox" id="ejercicio_respuestas_[[$index]]_correcta" value="1" ng-model="opciones[$index].checked" ng-click="updateSelection($index, opciones)" >
                                </span>
                                <div ng-bind-html="[[ ejercicio.respuestas[$index] ]]" class="form-control">[[ respuesta]] {#[[respuesta.expresion ]]#}</div>
                            </div>
                        </li>
                    </ul>
                </div>
                <div ng-if="correcto" class="col-xs-12 alert alert-success" class="animate-if">
                    <h4><i class="icon fa fa-check"></i> Correcto!</h4>
                </div>
                <div ng-if="incorrecto" class="col-xs-12 alert alert-danger" class="animate-if">
                    <h4><i class="icon fa fa-close"></i> Incorrecto!</h4>
                </div>
                <div ng-show="finalizado" class="col-lg-3 col-xs-6">
                    <div class="small-box bg-yellow">
                        <div class="inner">
                            <h3>Inicio</h3>
                            <p></p>
                        </div>
                        <div class="icon">
                            <i class="ion ion-home"></i>
                        </div>
                        <a href="{{ path('homepage') }}" class="small-box-footer">Ir <i class="fa fa-arrow-circle-right"></i></a>
                    </div>
                </div>
                <div ng-show="finalizado" class="col-lg-3 col-xs-6">
                    <div class="small-box bg-green">
                        <div class="inner">
                            <h3>[[ aciertos ]]</h3>
                            <p>Aciertos</p>
                        </div>
                        <div class="icon">
                            <i class="ion ion-stats-bars"></i>
                        </div>
                    </div>
                </div>
                <div ng-show="finalizado" class="col-lg-3 col-xs-6">
                    <div class="small-box bg-blue">
                        <div class="inner">
                            <h3>[[ aciertos * 100 /4 ]]<sup style="font-size: 20px">%</sup></h3>
                            <p>Puntuaci√≥n</p>
                        </div>
                        <div class="icon">
                            <i class="ion ion-stats-bars"></i>
                        </div>
                    </div>
                </div>
            </div>
            <div class="box-footer" style="text-align: center;">
                <button ng-hide="finalizado || correcto || incorrecto" class="btn btn-success" ng-disabled="isValid()" ng-click="evaluar()">
                    [[ titulo_boton ]]</button>
                <button ng-show="!finalizado && (correcto || incorrecto)" id="practica_submit" class="btn btn-success" ng-click="siguiente()">[[ titulo_boton2 ]]</button>
                
            </div>
        </div>
    </section>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script type="text/javascript">
          var response = "{{ practica_json }}";
          var div = document.createElement('div');
          div.innerHTML = response;
          response = div.firstChild.nodeValue;
          response = JSON.parse(response);
          console.log("response",response);
    </script>

    <script src="{{ asset('bundles/app/plugins/MathJax/MathJax.js?config=TeX-AMS_HTML') }}"></script>

    <script src="{{ asset('bundles/app/angularjs/angular-sanitize.min.js')}}"></script>

    {% javascripts
        '@AppBundle/Resources/public/angularjs/startPractica/startPracticaModule.js'
        '@AppBundle/Resources/public/angularjs/startPractica/startPracticaController.js'%}
        <script src="{{ asset_url }}"></script>
    {% endjavascripts %}

    <script src="{{ asset('bundles/fosjsrouting/js/router.js') }}"></script>
    <script src="{{ path('fos_js_routing_js', {'callback': 'fos.Router.setData'}) }}"></script>
{% endblock %}